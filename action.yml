name: 'Trivy Summary and Teams Notification'
description: 'Gera summary do Trivy e envia notificação para Power Automate/Teams'
inputs:
  trivy-json:
    description: 'Caminho do arquivo JSON de ouput da action Trivy'
    required: true
  docker-image:
    description: 'Nome da imagem Docker a ser analisada'
    required: true
runs:
  using: "composite"
  steps:
    - name: Install jq
      shell: bash
      run: sudo apt-get update && sudo apt-get install -y jq

    - name: Generate Trivy Summary and Send Notification
      shell: bash
      run: |
        bash ${{ github.action_path }}/scripts/trivy-summary.sh "${{ inputs.trivy-json }}" "${{ inputs.docker-image }}"